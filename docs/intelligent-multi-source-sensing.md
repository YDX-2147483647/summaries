---
relevant:
  - ./signals-and-systems.md
  - ./artificial-intelligence.md
---

# 智能多源感知

## 3 距离分辨率和角分辨率

> :material-clock-edit-outline: 2022年3月17日。

我们讲了两种处理啁啾信号的方法——脉冲压缩、去斜。其中脉冲压缩是通用方法，去斜则只适用于啁啾信号。（两种方法的分辨率同量级，我感觉去斜更容易理解。）

### 脉冲压缩

“脉冲压缩”字面指这种处理方法的效果，让宽脉冲也能有窄脉冲的效果。（窄脉冲距离分辨率高；宽脉冲能量大，从而测距范围大）

具体实现就像某种书上的解密卡片，只有“滑动窗”平移到刚好和信号中的回波完全重合时才有显著输出。“比较是否重合”就是给两个信号内积，比较一系列不同位置的滑动窗就是卷积/相关。

### 去斜

去斜是在“瞬时频率 $f$—时间 $t$”意义上讨论的。

啁啾信号可表示成 $x = A \exp(i 𝜑)$，$𝜑 = \pi K t^2+ \cdots$，这样 $\dv{\varphi}{t} = 2\pi Kt + \cdots$ 就是瞬时（角）频率，它随时间线性变化，$K$ 称为“调频”率。

若有两个信号 $x = (\cdots) \exp(i 𝜑)$、$y = (\cdots) \exp(i ψ)$，很容易构造它们的相位差：$x y^* = (\cdots) \exp(i (𝜑-ψ))$。注意 $x,\ y,\ xy^*$ 的频率，其实频率差也构造出来了。（此即“差拍”）

雷达测距把位置差转化为时间差。由于线性调频，时间差可继续转化成频率差。

- 准备一个本振信号作为基准，它满足 $f = K t$。（时间原点是接收机开始工作的时刻，不一定是发射时刻。）
- 回波（的非零部分）满足 $f = K (t-t_0)$，其中 $t_0$ 是回波前沿到达的时刻，反映目标距离。
- 作差拍，它（在回波非零时段）满足 $f = K t_0$，频率稳定。
- 再变换到频域，$K t_0$ 频率稳定存在了一段时间，会出现主峰；其它频率不曾稳定存在，基本没有。
  因此，只要把主峰的频率记下，就可反推出 $t_0$，从而进一步测距。

现在讨论分辨率。

设有两个目标，它们在频域各自形成一峰，（认为）两峰间距大于峰宽时才可分辨出。两峰间距取决于距离差，峰宽取决于时域宽度，即回波（非零部分）的时长。（→幻灯片 19 页）

### 带宽

零带宽的信号只有持续时间无限长的正弦波，实际信号是持续时间有限的多种正弦波的叠加，有两种因素导致带宽。

- 对于简单脉冲，主要因素是持续时间。
- 对于啁啾信号，主要因素是人为混入的各种频率。（算一下会发现 $KT \gg 1/T$。）粗略估计可考虑“频率$f$—时间$t$”图，把那条图线在频率轴的投影当作频带，从而带宽是 $KT$。

### 距离分辨率

从我们课上的论证看，脉冲压缩和去斜的距离分辨略都是 $c/(2B)$ 只是巧合。

时间分辨率为 $1/B$ （相当于距离分辨率为 $c/2 × B$）是算出来的，在幻灯片11页至14页。

## 4 信号检测、匹配滤波、雷达方程

> :material-clock-edit-outline: 2022年4月17日。

距离“不模糊”指回波周期性不会有影响。

## 10 代价函数匹配激活函数

> :material-clock-edit-outline: 2022年5月3日。

避免导数太小。

代价函数 $J = \eval{J}_{\vb* a}$，激活 $a_\mu = g(z_\mu)$。希望反向传播的起始 $\delta_\mu = \pdv{z_\mu} J$ 不致太小。

$$
\delta_\mu = \eval{g'}_{a_\mu} \pdv{J}{a_\mu}.
$$

$g$ 是 Logistic 函数时，$g'$ 很有可能非常小。若 $J$ 是离差平方和，则无法抑制。

$$
\begin{cases}
    \ln a, & y=1. \\
    \ln(1-a), & y=0. \\
\end{cases}
$$

若 $J$ 是交叉熵（如上），则 $\pdv{a_\mu} J$ 可响应除以掉，最终 $\delta_\mu = a_\mu - y_\mu$，不会太小。

---

跳出来看，原来希望$\pdv{a_\mu} J = \qty(a_\mu-y_\mu) / \eval{g'}_{a_\mu}$。

比如 soft-max 激活函数

$$
a_i = \frac{\exp z_i}{\sum_j \exp z_j}.
$$

试试解那个方程？

$$
\begin{split}
    \pdv{a_\mu} J
    &= \frac{a_\mu - y_\mu}{\pdv{a_\mu}{z_\mu}} \\
    &= \frac{a_\mu - y_\mu}{a_\mu - \frac{a_\mu}{\sum \exp z} \times \exp z_\mu} \\
    &= \frac{a_\mu - y_\mu}{a_\mu (1 - a_\mu)} \\
    &= \begin{cases}
        - \frac{1}{1-a_\mu}, & y_\mu = 0. \\
        - \frac{1}{a_\mu}, & y_\mu = 1.
    \end{cases}
\end{split}
$$

若忽略 $y=0$，则对应对数似然代价函数 $y \log a$。（其它输出不会放任自流，有其它样本限制着。）
