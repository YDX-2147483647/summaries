---
relevant:
  - ./digital-signal-processing.md
---

# 高级数字信号处理

$$
\def\Z{\mathbb{Z}}
\def\period#1{\left<#1\right>}
$$

## §4–§5 采样率转换

### 转换采样率

> :material-clock-edit-outline: 2023年6月1日。

- **下采样** $M \in \Z$ 倍

  $y(m) = x(mM)$ 可理解成两步。
  
  1. 先把 $x(n)$ 取样点以外的点置零（时域乘周期化 $\delta$，频域周期混叠）。
  2. 再把零去掉（时域压紧，频域拉宽，$z \mapsto z^{1/M}$）。

  $$
  \eval{Y}_z = \frac{1}{M} \sum_{k \in \period{M}} \eval{X}_{z^{1/M} W^k},
  $$

  其中 $W = e^{-2\pi k / M}$。

  !!! note "频率域"

      以上是用数字频率 $\omega$ 讨论。注意转换采样率后，$\omega$ 与模拟频率 $\Omega$ 的映射关系改变了，而就 $\Omega$ 而言，频谱只是变了延拓的周期，所在频率并无变化。

      讨论上采样也类似。

  为避免信号带外噪声混入信号，下采样前要经抗混叠滤波器。

- **上采样** $L \in \Z$ 倍

  $y(m) = x(m/L)$，$m/L \not\in \Z$ 时规定为零。时域插零即频域压缩。

  $$
  \eval{Y}_z = \eval{X}_{z^L}.
  $$

  为尽可能还原信号，上采样后要经抗镜像滤波器。

### 设计数字滤波器

> :material-clock-edit-outline: 2023年6月1日。

原初版本的抗混叠或镜像滤波器都工作在采样率较高的一端，计算量大，对器件要求很高。而且倍数较高时，要求滤波器通带、过渡带很窄，很难实现。事实上都可以改进。

- **带宽**

  通带太宽、太窄都难设计。

  可分**多级**实现，逐级滤波。

- **计算量**

  按改进效果递增有如下方法。

  1. **多相实现**

    :material-eye-arrow-right: [Cooley–Sande–Tukey 算法](./digital-signal-processing.md#CooleySandeTukey-算法)。

    Cooley–Sande–Tukey 算法将一维数据重整为二维，将一次 DFT 化为两次，优先排的维度后 DFT。

    转换采样率 $z^\alpha \mapsto z^\beta$ 时，输入端有一滤波器，如果它可表示为 $H(z^\alpha)$，则可等效为输出端的 $H(z^\beta)$。这样滤波器的速率、阶数都降低了。

    可让靠内的一次 DFT 刚好是这种情况——高速一端原有一路串行转多路并行，每一支路降速到与低速一端一致。这些支路采样率一样，但串并转换时有延时，相位不同，因而称作“多相”。

    这种方法除了降速，还同时减少了总乘法次数，减少比例等于采样率转换倍数。

    !!! note "DFT 与滤波"

        以上讨论 DFT，与需要的滤波还有一定差距。FIR 基本类似，IIR 比较困难。

  2. **半带**

    即使 $2\Z - \qty{0}$ 处的 $h$ 都为零，少一半系数，也能实现二倍采样率变换所需的滤波。

    这和[无码间串扰条件](./digital-communication.md#码间串扰)数学结构类似，频域条件是频率响应按低速一端的采样率混叠后，响应对所有频率一致。具体到二倍实滤波器，条件是 $H$–$\omega$ 图象在 $\omega \in (0, \pi)$ 内关于 $\omega = \pi/2$ 的某点中心对称。

    这种滤波器不可能完全保证无混叠或镜像。

  3. **Cascaded integrator-comb**

    只用加减、延时也能实现滤波。这种滤波器几乎没有计算量，可以用到非常高速的地方。

    单级响应

    $$
    H = \frac{1 - 1 / z^D}{1 - 1/z}.
    $$

    - 分子梳状，零点为 $\omega = 2 \pi \Z / D$，可等效到低速一端。
    - 分母（的倒数）积分，$y(n) - y(n-1) = x(n)$，极点为 $\omega = 2\pi \Z$。

    注意 $z = 1$ 处 $H = D$，$D$ 可能很大。这可能导致数字滤波器溢出。

    单级阻带抑制很差，可串联多级改进，不过那样通带又不平了（带内容差也会积累）。
